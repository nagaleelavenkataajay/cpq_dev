result = "";
orderEffectiveDateBillingException = orderEffectiveDateBillingException_quote;
annualBundleBillingException = annualBundleBillingException_quote;
preproductionBillingException = preproductionBillingException_quote;
submitOrderDateBillingException = submitOrderDateBillingException_quote;
timeMaterialsBillingException = timeMaterialsBillingException_quote;
promotionBillingException = promotionBillingException_quote;
professionalServTerminationBillingException = professionalServTerminationBillingException_quote;
billingExceptionCommentsHDS = billingExceptionCommentsHDS_quote;
vARResellBillingException = vARResellBillingException_quote;
pONumException = pONumException_quote;
futureOEDBillingException = futureOEDBillingException_quote; //IESCNQRCPQ-264 (OK. 2-9-2023) Future OED Billing Exception
bllingExceptionForManualLegalPromotion = bllingExceptionForManualLegalPromotion_quote; //IESCNQRCPQ-196 (SV. 18-05-2023)
delim = "$@#";
pipeDelim = "|||";
billingExceptionsExists = "";

//CSYS-104211 (OK. 2-18-2022)
tFSDOverrideBillingException = tFSDOverrideBillingException_quote;
if (containskey(attributesDict, "TFSDBillingExceptionReason") == true) {
	tFSDOverrideBillingException = get(attributesDict, "TFSDBillingExceptionReason", "string"); 
}

if(purchasedFromPartnerCategorySFDC_quote == "VAR"){
	if (purchasedFromPartnerCategorySFDC_quote <> vARResellBeforeApproval_quote){
	varResellBillingException = "The Partner Category VAR has been added to the Account AFTER the quote was approved.  The Transaction Fee Start Date is now incorrect, will print incorrectly on the contract and will negatively impact the billing start date.  PLEASE Revise, Save, and Resubmit.";
	}
}

//CSYS-104211 (OK. 2-18-2022) TFSD Override billing exception added in below condition
if(orderEffectiveDateBillingException <> "" OR annualBundleBillingException <> "" OR preproductionBillingException <> "" OR submitOrderDateBillingException <> "" OR timeMaterialsBillingException <> "" OR promotionBillingException <> "" OR professionalServTerminationBillingException <> "" OR billingExceptionCommentsHDS <> "" OR pONumException <> "" OR tFSDOverrideBillingException <> "" OR vARResellBillingException <> "" OR futureOEDBillingException <> "" OR bllingExceptionForManualLegalPromotion <> ""){
	if(orderEffectiveDateBillingException == "flagged"){		
		result = "Order Effective Date Billing Exception~"+orderEffectiveDateBillingException+delim+"Annual Bundling Billing Exception~"+annualBundleBillingException+delim+"Pre Production Billing Exception~"+preproductionBillingException+delim+"Submit Order Billing Exception~"+submitOrderDateBillingException+delim+"Time & Material Billing Exception~"+timeMaterialsBillingException+delim+"Promotion Billing Exception~"+promotionBillingException+delim+"Professional Service Termination Billing Exception~"+professionalServTerminationBillingException+delim+"HDS Billing Exception~"+billingExceptionCommentsHDS+delim+"PO Number Exception~"+pONumException+delim+"Transaction Fee Start Date Override Billing Exception~"+tFSDOverrideBillingException+delim+"VAR Resell Billing Exception~"+vARResellBillingException+delim+"Future Order Effective Date Billing Exception~"+futureOEDBillingException+delim+"Manual Legal Promotion Billing Exception~"+bllingExceptionForManualLegalPromotion+delim;
	}
	else{
		result = "Annual Bundling Billing Exception~"+annualBundleBillingException+delim+"Pre Production Billing Exception~"+preproductionBillingException+delim+"Submit Order Billing Exception~"+submitOrderDateBillingException+delim+"Time & Material Billing Exception~"+timeMaterialsBillingException+delim+"Promotion Billing Exception~"+promotionBillingException+delim+"Professional Service Termination Billing Exception~"+professionalServTerminationBillingException+delim+"HDS Billing Exception~"+billingExceptionCommentsHDS+delim+"PO Number Exception~"+pONumException+delim+"Transaction Fee Start Date Override Billing Exception~"+tFSDOverrideBillingException+delim+"VAR Resell Billing Exception~"+vARResellBillingException+delim+"Future Order Effective Date Billing Exception~"+futureOEDBillingException+delim+"Manual Legal Promotion Billing Exception~"+bllingExceptionForManualLegalPromotion+delim;
	}
}
if(result <> ""){ 
	res = "";
	splitString = split(result, delim);
	for each in splitString {//to concatenate only those comments which have value
		eachSplit = split(each, "~"); //split with ~ to inorder to separate the label and comment
		//if (each <> "" AND NOT(isnull(each))){
		if (eachSplit[1]<> "" AND NOT(isnull(eachSplit[1]))){//check eachSplit[1] as it holds the comment
			res = res+each+pipeDelim; //to delimit with pipeDelim
		}		
	}	
	result = substring(res, 0, len(res)-3); //to remove the last pipeDelim
}

return result;